{% extends 'base.html' %}

{% block title %}角色管理 - 舆情分析系统{% endblock %}

{% block content %}
    <div class="layui-card">
        <div class="layui-card-header">角色管理</div>
        <div class="layui-card-body">
            <div class="layui-btn-container">
                <button type="button" class="layui-btn layui-btn-primary"><i class="layui-icon layui-icon-add-circle"></i> 添加角色</button>
            </div>
            <table class="layui-table" lay-data="{id:'roleTable', page:true, limit:10}" lay-filter="roleTable">
                <thead>
                    <tr>
                        <th lay-data="{field:'id', width:80}">ID</th>
                        <th lay-data="{field:'name', width:150}">角色名称</th>
                        <th lay-data="{field:'description'}">角色描述</th>
                        <th lay-data="{field:'action', width:200, toolbar:'#roleBar'}">操作</th>
                    </tr>
                </thead>
                <tbody>
                    {% for role in roles %}
                    <tr>
                        <td>{{ role.id }}</td>
                        <td>{{ role.name }}</td>
                        <td>{{ role.description }}</td>
                        <td></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- 操作栏模板 -->
    <script type="text/html" id="roleBar">
        <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
    </script>
{% endblock %}

{% block scripts %}
<script>
    layui.use(['element', 'table', 'layer', 'form'], function() {
        var element = layui.element;
        var table = layui.table;
        var layer = layui.layer;
        var form = layui.form;
        
        // 渲染表格
        table.render({
            elem: '#roleTable'
        });
        
        // 监听工具条
        table.on('tool(roleTable)', function(obj) {
            var data = obj.data;
            if (obj.event === 'edit') {
                // 编辑角色
                layer.msg('编辑角色：' + data.id);
            } else if (obj.event === 'del') {
                // 删除角色
                layer.confirm('确定要删除该角色吗？', function(index) {
                    layer.close(index);
                    layer.msg('删除角色：' + data.id);
                });
            }
        });
    });
</script>
{% endblock %}