<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ title }} - 信息检查系统{% endblock %}</title>
    <!-- 引入Layui CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='layui/css/layui.css') }}">
    <style>
        body {
            background-color: #f5f7fa;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .login-container {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
            padding: 30px;
            width: 100%;
            max-width: 400px;
        }
        .login-header {
            text-align: center;
            margin-bottom: 20px;
        }
        .login-header .logo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: #1E9FFF;
            margin: 0 auto 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 30px;
            color: #fff;
        }
        .login-header h2 {
            margin: 0;
            font-size: 20px;
            color: #333;
        }
        .login-header p {
            margin: 5px 0 0;
            font-size: 14px;
            color: #999;
        }
        .login-form .layui-form-item {
            margin-bottom: 20px;
            clear: both;
        }
        .login-form .layui-input-block {
            margin-left: 0;
            width: 100%;
        }
        .login-form .layui-input-group {
            width: 100%;
        }
        .login-form .layui-input {
            height: 40px;
            border: 1px solid #e6e6e6;
        }
        .login-actions {
            margin-top: 30px;
            width: 100%;
        }
        .login-actions .layui-btn {
            width: 100%;
            height: 40px;
            font-size: 16px;
            border: none;
            background-color: #1E9FFF;
            color: white;
        }
        .login-actions .layui-btn:hover {
            background-color: #40a9ff;
        }
        .login-footer {
            text-align: center;
            margin-top: 20px;
            font-size: 12px;
            color: #999;
        }
        .login-footer a {
            color: #1E9FFF;
        }
        /* 修复记住我复选框的空白小框问题 */
        .login-form .layui-form-item:last-child {
            margin-bottom: 0;
        }
        /* 移除Layui生成的额外空白 */
        .login-form .layui-form-item .layui-input-block {
            line-height: normal;
            padding: 0;
        }
        /* 调整复选框和标签的位置 */
        .login-form .layui-form-item .layui-input-block .layui-form-checkbox {
            margin: 0;
            padding-right: 0;
        }
        /* 确保Layui生成的复选框容器没有多余的高度 */
        .login-form .layui-form-item .layui-input-block {
            height: auto;
            min-height: 30px;
        }
        /* 修复复选框旁边的空白小框 */
        .login-form .remember-me {
            margin-bottom: 10px;
        }
        .login-form .remember-me .layui-input-block {
            position: relative;
        }
        .login-form .remember-me .layui-input-block .layui-form-checkbox {
            position: static;
            display: inline-block;
            margin-right: 0;
            margin-left: 0;
            padding-right: 0;
            padding-left: 0;
            height: auto;
            line-height: normal;
        }
        .login-form .remember-me .layui-input-block .layui-form-checkbox span {
            display: inline-block;
            vertical-align: middle;
            margin-right: 0;
            padding-right: 0;
        }
        .login-form .remember-me .layui-input-block .layui-form-checkbox i {
            display: inline-block;
            vertical-align: middle;
            margin-right: 5px;
            margin-left: 0;
            width: 16px;
            height: 16px;
            line-height: 14px;
        }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="login-header">
            <div class="logo">
                <i class="layui-icon layui-icon-vercode"></i>
            </div>
            <h2>用户登录</h2>
            <p>请输入您的账号和密码</p>
        </div>
        <form class="login-form" method="POST" action="">
            {{ form.hidden_tag() }}
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <div class="layui-input-group" style="width: 100%;">
                        <span class="layui-input-group-addon" style="padding: 0 10px;">
                            <i class="layui-icon layui-icon-username" style="font-size: 16px;"></i>
                        </span>
                        {{ form.username(class="layui-input", placeholder="请输入用户名", style="width: calc(100% - 40px); height: 40px;") }}
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <div class="layui-input-group" style="width: 100%;">
                        <span class="layui-input-group-addon" style="padding: 0 10px;">
                            <i class="layui-icon layui-icon-password" style="font-size: 16px;"></i>
                        </span>
                        {{ form.password(class="layui-input", placeholder="请输入密码", type="password", style="width: calc(100% - 40px); height: 40px;") }}
                    </div>
                </div>
            </div>
            <div class="layui-form-item remember-me">
                <div class="layui-input-block">
                    <!-- 直接使用HTML复选框而非Layui自动生成的结构 -->
                    <div class="custom-checkbox">
                        <input type="checkbox" name="remember" id="remember" style="display: none;">
                        <label for="remember" style="display: inline-flex; align-items: center; cursor: pointer;">
                            <span class="checkbox-icon" style="width: 16px; height: 16px; border: 1px solid #d2d2d2; border-radius: 2px; margin-right: 6px; display: inline-block; position: relative;">
                                <i class="layui-icon layui-icon-ok" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 12px; color: #1E9FFF;"></i>
                            </span>
                            <span>记住我</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="login-actions">
                {{ form.submit(class="layui-btn layui-btn-primary") }}
            </div>
        </form>
        <div class="login-footer">
            <div>其他登录方式</div>
            <div style="margin-top: 10px;">
                <i class="layui-icon layui-icon-login-qq" style="font-size: 20px; color: #12B7F5; margin-right: 15px;"></i>
                <i class="layui-icon layui-icon-login-wechat" style="font-size: 20px; color: #00D856; margin-right: 15px;"></i>
            </div>
            <div style="margin-top: 10px;">
                <a href="#">忘记密码？</a> | <a href="#">联系客服</a>
            </div>
        </div>
    </div>
    <!-- 引入Layui JavaScript -->
    <script src="{{ url_for('static', filename='layui/layui.js') }}"></script>
    
    {% block scripts %}
    <script>
        // 处理自定义复选框
        document.addEventListener('DOMContentLoaded', function() {
            var rememberCheckbox = document.getElementById('remember');
            var checkboxLabel = document.querySelector('label[for="remember"]');
            var checkboxIcon = document.querySelector('.checkbox-icon i');
            
            // 点击标签时切换复选框状态
            checkboxLabel.addEventListener('click', function() {
                rememberCheckbox.checked = !rememberCheckbox.checked;
                
                if (rememberCheckbox.checked) {
                    checkboxIcon.style.display = 'block';
                    // 给复选框添加checked属性，确保表单提交时能正确获取值
                    rememberCheckbox.setAttribute('checked', 'checked');
                } else {
                    checkboxIcon.style.display = 'none';
                    // 移除checked属性
                    rememberCheckbox.removeAttribute('checked');
                }
            });
            
            // 监听原生复选框的change事件，确保状态同步
            rememberCheckbox.addEventListener('change', function() {
                if (this.checked) {
                    checkboxIcon.style.display = 'block';
                } else {
                    checkboxIcon.style.display = 'none';
                }
            });
        });
        
        layui.use(['form', 'layer'], function() {
            var form = layui.form;
            var layer = layui.layer;
            
            // 表单验证
            form.verify({
                username: function(value, item) {
                    if (value.length === 0) {
                        return '用户名不能为空';
                    }
                },
                password: function(value, item) {
                    if (value.length === 0) {
                        return '密码不能为空';
                    }
                }
            });
            
            // 提示消息
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        layer.msg('{{ message }}', {icon: {{ '1' if category == 'success' else '5' }}});
                    {% endfor %}
                {% endif %}
            {% endwith %}
        });
    </script>
    {% endblock %}
</body>
</html>